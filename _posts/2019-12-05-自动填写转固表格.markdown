---
title:  "自动填写转固表格"
date:   2019-12-05 22:00:00
categories: [Needs]
tags: [Ideas]
---
## 自动填写转固表格

### 需求

- 从指定excel读取数据，自动生成规定格式转固表
- 能够将文件名命名为工程编号
- 读取并在指定位置填写数据，包括建设地址，填表时间，转固日期，资产类别编码，单价，税率，不含税价等
- 自动打印（可选）
- 可能要多个版本，2019年新工程包含安全生产费；2017-2018年工程填的是不含税；2016年以前填的是含税

### 功能实现

- 读取excel数据可使用pandas包和xlrd包
- 写入excel使用 ，写入指定单元格使用  ，
- 重命名excel使用  ，
- 打印使用  ，

### 运行逻辑

- 从已完备excel读取几个填写数据的列数据，存储为list对象√
- 对于每个工程编号：
  1. 创建新文件
  2. 在指定位置写入相关数据
  3. 保存并重命名文件
  4. （打印并）退出

### 思考

- ~~可能用list完成不了，因为工程编号需要和相关数据一一对应~~
- ~~可能要考虑用到数据库？~~
- ~~字典能否完成这一对应关系，字典一键多值，可以考虑key对应一个列表~~
- ~~然后考虑一键多值如何分别取值~~
- 重命名问题不大
- 遍历字典
- ~~.xlsx格式可能无法支持，目前比较支持.xls格式~~
- 使用xlutils可以保留原格式修改
- 打印机import os；os.startfile('d:\\abc.xls','print')

